const devices = [
  {
    orderName: "Test_new_firmware_outlet",
    _id: "6363af1031c7633c0f7e1a3e",
    sn: "GEN_CNUO9HOEL7G5MQCC",
    qrcode: "X-HM://007K4VLYB6LZC",
    productId: "Outlet_v1.4.7",
    destination: "/home/ubuntu/iot/fw_generator/out/6363aeeec4d271250f0ddd58",
    setupCode: "804-30-307",
    setupId: "6LZC",
    orderId: "6363aeeec4d271250f0ddd58",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJ5eUx3bzhZNXlySk9oVldkbkNkS1RLcElwMjgyN2xOaGxkTnN5TEpoWlBNPSIsImlhdCI6MTY2NzQ3NzI2M30.L9yW__qVM60Xbyts5uHJQJa_JWqK0a8qOqMDyHLH3c8",
    __v: 0,
    iotDevice: {
      _id: "6389f03e8c88ce1e2d13e752",
      thingName: "007JDH70J8TAZ",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/007JDH70J8TAZ",
      thingId: "d42f0172-14e8-4d4b-890a-007JDH70J8TAZ",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "dsfgdsfg",
      cid: "7",
      Createdate: "2022-12-02T12:31:58.246Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-12-02_15:31",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VUL100",
    downloaded: false,
    Createdate: "2022-11-03T12:07:44.989Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "Test_new_firmware_outlet",
    _id: "6363af0c31c7633c0f7e1a39",
    sn: "GEN_KKYMADDC7GWQRACC",
    qrcode: "X-HM://007JKGJ4KMIU3",
    productId: "Outlet_v1.4.7",
    destination: "/home/ubuntu/iot/fw_generator/out/6363aeeec4d271250f0ddd58",
    setupCode: "461-34-484",
    setupId: "MIU3",
    orderId: "6363aeeec4d271250f0ddd58",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJibjdOcm5NREVBNDNlOHA4aTAyVUMzbkVjd1hZOW14a1hjM2pBcEwxQlpJPSIsImlhdCI6MTY2NzQ3NzI1OX0.6y5TVigJK-2PBGmKs66bWDV5gGAUyPCfwo3acSX_klM",
    __v: 0,
    iotDevice: {
      _id: "6389f0388c88ce1e2d13e74c",
      thingName: "007K1IG0MMYPB",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/007K1IG0MMYPB",
      thingId: "d42f0172-14e8-4d4b-890a-007K1IG0MMYPB",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "dsfgdsfg",
      cid: "7",
      Createdate: "2022-12-02T12:31:52.960Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-12-02_15:31",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VUL100",
    downloaded: false,
    Createdate: "2022-11-03T12:07:40.879Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "Test_new_firmware_outlet",
    _id: "6363af0831c7633c0f7e1a34",
    sn: "GEN_ORZKOPNJVEI5WGCC",
    qrcode: "X-HM://007K8O7Y4RCTD",
    productId: "Outlet_v1.4.7",
    destination: "/home/ubuntu/iot/fw_generator/out/6363aeeec4d271250f0ddd58",
    setupCode: "868-04-028",
    setupId: "RCTD",
    orderId: "6363aeeec4d271250f0ddd58",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJtZnZWOHMxYXo5OXlnT2JBV2NZdlBneDU3NUEwZjFtNHNXTzlmYXBobC9vPSIsImlhdCI6MTY2NzQ3NzI1NX0.OV1xBmq9_bQwEov_5iTT-J2oLCTj4cvhCpoFXo3Jk5M",
    __v: 0,
    iotDevice: {
      _id: "6389bc578c88ce1e2d13e746",
      thingName: "007K5D1BWFWYL",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/007K5D1BWFWYL",
      thingId: "d42f0172-14e8-4d4b-890a-007K5D1BWFWYL",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "ghfjfhjf",
      cid: "7",
      Createdate: "2022-12-02T08:50:31.019Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-12-02_11:50",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VUL100",
    downloaded: false,
    Createdate: "2022-11-03T12:07:36.715Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "Test_new_firmware_outlet",
    _id: "6363af0431c7633c0f7e1a2f",
    sn: "GEN_UPH227Z51HKQ0WCC",
    qrcode: "X-HM://007JZ08KAEOVA",
    productId: "Outlet_v1.4.7",
    destination: "/home/ubuntu/iot/fw_generator/out/6363aeeec4d271250f0ddd58",
    setupCode: "705-68-538",
    setupId: "EOVA",
    orderId: "6363aeeec4d271250f0ddd58",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJNaW5GcXNsWjNsVU5wMHE0Ti85RnplZ3F1d3lKNDBPekxHdTdsNjN0QnQwPSIsImlhdCI6MTY2NzQ3NzI1MX0.rqDUPWKWYKYtQKTyN5XM2Ok_FiRU6VHnObHB6EL9MhE",
    __v: 0,
    iotDevice: {
      _id: "634d07cd579f21844b06c392",
      thingName: "007JF8S40KT4I",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/007JF8S40KT4I",
      thingId: "d42f0172-14e8-4d4b-890a-007JF8S40KT4I",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "jkdfshkgds",
      cid: "7",
      Createdate: "2022-10-17T07:44:13.518Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-10-17_10:44",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VUL100",
    downloaded: false,
    Createdate: "2022-11-03T12:07:32.728Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "Test_new_firmware_outlet",
    _id: "6363af0031c7633c0f7e1a2a",
    sn: "GEN_QRUEAFT5LNNSAACC",
    qrcode: "X-HM://007K72QOC87V2",
    productId: "Outlet_v1.4.7",
    destination: "/home/ubuntu/iot/fw_generator/out/6363aeeec4d271250f0ddd58",
    setupCode: "841-22-252",
    setupId: "87V2",
    orderId: "6363aeeec4d271250f0ddd58",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJLczVOV0RCWWN2ZmgxQnJCT21EdlBxZGR0K0F4R3VIQkJOdFA5YW0vUU5nPSIsImlhdCI6MTY2NzQ3NzI0Nn0.-bZpL6RtsMO6MqE5321FyhpaG5sVFy8HkCVFOSrms6I",
    __v: 0,
    iotDevice: {
      _id: "63493cf7e172d67aa3d3bb78",
      thingName: "007JTBW4OE784",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/007JTBW4OE784",
      thingId: "d42f0172-14e8-4d4b-890a-007JTBW4OE784",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "kczlkgfd",
      cid: "7",
      Createdate: "2022-10-14T10:41:59.058Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-10-14_13:41",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VUL100",
    downloaded: false,
    Createdate: "2022-11-03T12:07:28.013Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "Test_new_firmware_outlet",
    _id: "6363aef831c7633c0f7e1a24",
    sn: "GEN_KJU7NCUOOOKJOGCC",
    qrcode: "X-HM://007JO9BT52SB1",
    productId: "Outlet_v1.4.7",
    destination: "/home/ubuntu/iot/fw_generator/out/6363aeeec4d271250f0ddd58",
    setupCode: "525-16-873",
    setupId: "2SB1",
    orderId: "6363aeeec4d271250f0ddd58",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJGUDlnck1SVjUvSUJ4RjhrYkFJZGl0Nkk2UzRnQ0d6Tlk5aDNJZHA0Vk5jPSIsImlhdCI6MTY2NzQ3NzIzOX0.vQtA0yH1Ak5sSVeaat8sol5zeZDmDsGe9KPXPg9vLLg",
    __v: 0,
    iotDevice: {
      _id: "63493cdee172d67aa3d3bb5f",
      thingName: "007JDHPN5D26O",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/007JDHPN5D26O",
      thingId: "d42f0172-14e8-4d4b-890a-007JDHPN5D26O",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "kczlkgfd",
      cid: "7",
      Createdate: "2022-10-14T10:41:34.619Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-10-14_13:41",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VUL100",
    downloaded: false,
    Createdate: "2022-11-03T12:07:20.991Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "VLS100_HCA_V1",
    _id: "635640ecdfa593637ea5ac22",
    sn: "GEN_RFRJ6VUEWK5BLQCC",
    qrcode: "X-HM://008JJ2NCQ9IPD",
    productId: "VLS100_HCA",
    destination: "/home/ubuntu/iot/fw_generator/out/635640d8958f114c7e5884ff",
    setupCode: "731-05-850",
    setupId: "9IPD",
    orderId: "635640d8958f114c7e5884ff",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJ4M3V0VEh3UEdPL3BmWVI4N2JXTUZKa3NmMUtkYldOTXliV1pDejdNcSs4PSIsImlhdCI6MTY2NjU5NzA5OX0.PGXDm0-GH9y4YgiWT3iIEE37s4wqo2lsscSGub0A3Ag",
    __v: 0,
    iotDevice: {
      _id: "633e91ecc9459bfc47a52640",
      thingName: "005KUG5KHVA8Q",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/005KUG5KHVA8Q",
      thingId: "d42f0172-14e8-4d4b-890a-005KUG5KHVA8Q",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "sdgfsdgs",
      cid: "5",
      Createdate: "2022-10-06T08:29:32.471Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-10-06_11:29",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VLS100US",
    downloaded: false,
    Createdate: "2022-10-24T07:38:20.567Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "VLS100_HCA_V1",
    _id: "635640e5dfa593637ea5ac1c",
    sn: "GEN_WFKPWJ32LQI44WCC",
    qrcode: "X-HM://008IMAPDA9ALG",
    productId: "VLS100_HCA",
    destination: "/home/ubuntu/iot/fw_generator/out/635640d8958f114c7e5884ff",
    setupCode: "180-54-382",
    setupId: "9ALG",
    orderId: "635640d8958f114c7e5884ff",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiI3eHRTNi83Mm1LZkI1eHZ5d2p1dlE4cC9SQmZ5RnZZZHJGeTdZWkp0UURjPSIsImlhdCI6MTY2NjU5NzA5Mn0.MFmBuOIBhj4CH8eW9a7VzLtL1eRhJ9DAOWoj_RvnAEs",
    __v: 0,
    iotDevice: {
      _id: "633e8e563e1c5212307806e5",
      thingName: "005JV4A56OVA4",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/005JV4A56OVA4",
      thingId: "d42f0172-14e8-4d4b-890a-005JV4A56OVA4",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "ghfghjfgh",
      cid: "5",
      Createdate: "2022-10-06T08:14:14.113Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-10-06_11:14",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VLS100US",
    downloaded: false,
    Createdate: "2022-10-24T07:38:13.912Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
  },
  {
    orderName: "Test_new_firmware_outlet",
    _id: "6363af1431c7633c0f7e1a43",
    sn: "GEN_H8A9DDN8Z9NIGGCC",
    qrcode: "X-HM://007JYZGMNZH19",
    productId: "Outlet_v1.4.7",
    destination: "/home/ubuntu/iot/fw_generator/out/6363aeeec4d271250f0ddd58",
    setupCode: "705-32-335",
    setupId: "ZH19",
    orderId: "6363aeeec4d271250f0ddd58",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJLelhjNkN1ZUZVbEtSWGJ0N0JoaG0rK0JyZUJkb2hOeXhDVUd0WXRPUjNrPSIsImlhdCI6MTY2NzQ3NzI2N30.M1S7cc8P-Y9twmJM9jYRyMNLxVqjRfLx_k8jtDiJKeE",
    __v: 0,
    iotDevice: {
      _id: "633e8e403e1c5212307806a9",
      thingName: "005K5SLV4W6LD",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/005K5SLV4W6LD",
      thingId: "d42f0172-14e8-4d4b-890a-005K5SLV4W6LD",
      appId: "5b236954c4fbb64e7ddf36c5",
      thingGroupName: "ghfghjfgh",
      cid: "5",
      Createdate: "2022-10-06T08:13:52.127Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-05-23_11:04",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VUL100",
    downloaded: false,
    Createdate: "2022-11-03T12:07:48.940Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
    g: "2",
  },
  {
    orderName: "VLS103_HCA_V3",
    _id: "63527565dfa593637ea5ac16",
    sn: "GEN_HEJN6QDSDXYJVWCC",
    qrcode: "X-HM://008IRF63N0GLU",
    productId: "VLS103_HCA",
    destination: "/home/ubuntu/iot/fw_generator/out/6352755a958f114c7e5884e6",
    setupCode: "266-60-771",
    setupId: "0GLU",
    orderId: "6352755a958f114c7e5884e6",
    appId: "60f178bccf15deea5b50f2e1",
    userId: "",
    deviceType: "wifi",
    apiToken:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aGluZ05hbWUiOiJ4MW5vdE5UTE9uZEZHck1DMWN0UkNmYXJTWG5TR2NGYkVwVW5Qb0VsWVNZPSIsImlhdCI6MTY2NjM0ODM4OH0.ThRGpVvJRCStt7nNcCVC2gkKKp5gqG0OZh_t51A-USE",
    __v: 0,
    iotDevice: {
      _id: "628b3fed2cb8742153f0139f",
      thingName: "007JH2LY8OURV",
      thingArn: "arn:aws:iot:ap-southeast-1:472819633775:thing/007JH2LY8OURV",
      thingId: "d42f0172-14e8-4d4b-890a-007JH2LY8OURV",
      appId: "5b236954c4fbb64e7ddf36c6",
      thingGroupName: "hnhjjjj",
      cid: "7",
      Createdate: "2022-05-23T08:03:57.979Z",
      certificateId: [],
      attributes: [
        {
          Createdate: "2022-05-23_11:03",
        },
      ],
      __v: 0,
    },
    hasCsvModel: true,
    product_type: "VLS103US",
    downloaded: false,
    Createdate: "2022-10-21T10:33:09.960Z",
    isTest: false,
    isGenerated: false,
    qrPrinted: false,
    isPacked: false,
    isTested: false,
    pcbaPassed: false,
    g: "1",
  },
];
const object = {
  startDate: 1653292920000,
  endDate: 1653293100000,
  sortBy: "g",
};

const filterDevise = (arr, obj) => {
  let res;
  let newArr = [];
  res = arr.forEach((elem) => {
    let filtered = elem.iotDevice.attributes.filter((item) => {
      return (
        Date.parse(item.Createdate.replace("_", "T")) > obj.startDate &&
        Date.parse(item.Createdate.replace("_", "T")) < obj.endDate
      );
    });
    if (filtered.length > 0) {
      newArr.push(elem);
    }
  });

  if (obj.sortBy.charAt(0) == "-") {
    newArr.sort((a, b) => (a[obj.sortBy] < b[obj.sortBy] ? 1 : -1));
  }
  newArr.sort((a, b) => (a[obj.sortBy] > b[obj.sortBy] ? 1 : -1));

  newArr.forEach((el) => {
    if (obj.sortBy.charAt(0) == "-") {
      if (typeof el[obj.sortBy.slice(1)] !== "string") {
        newArr = "Field should be a string";
      }
    } else if (typeof el[obj.sortBy] !== "string") {
      newArr = "Field should be a string";
    }
    if (obj.sortBy.charAt(0) == "-") {
      if (!(obj.sortBy.slice(1) in el)) {
        newArr = "Sort field incorrect";
      }
    } else if (!(obj.sortBy in el)) {
      newArr = "Sort field incorrect";
    }
  });

  return newArr;
};
console.log(filterDevise(devices, object));

// Дан массив объектов
// Необходимо создать функцию filterDevice, которая на входе принимает массив объектов, и объект для фильтрации

// Объект вида

// {
//     startDate - поле с которого начинается фильтрация по дате, передается в милисекундах
//     endDate - поле по которому заканчивается фильтрация по дате, передается в милисекундах
//     sortBy - текстовое поле в котором указано по какому полю в объекте необходимо провести сортировку
// }

// Поле сортировки приходит в таком формате "sn"  "-sn", это является направлением сортировки, где "-" означает сортировку по убыванию
// Сортировка должна происходить только по строковому полю, если же поле не является строкой выдать  сообщение "Field should be a string"
// Если же поля не существует в объекте, то вывести сообщение "Sort field incorrect"
